(function(t){function e(e){for(var i,o,a=e[0],c=e[1],u=e[2],h=0,d=[];h<a.length;h++)o=a[h],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&d.push(r[o][0]),r[o]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);l&&l(e);while(d.length)d.shift()();return s.push.apply(s,u||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],i=!0,a=1;a<n.length;a++){var c=n[a];0!==r[c]&&(i=!1)}i&&(s.splice(e--,1),t=o(o.s=n[0]))}return t}var i={},r={app:0},s=[];function o(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=i,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(n,i,function(e){return t[e]}.bind(null,i));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=e,a=a.slice();for(var u=0;u<a.length;u++)e(a[u]);var l=c;s.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";n("85ec")},"480d":function(t,e,n){"use strict";n("5f41")},"56d7":function(t,e,n){"use strict";n.r(e);n("b0c0"),n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("f9e3");var i=n("5f5b"),r=n("8203"),s=n.n(r),o=n("2b0e"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("div",{attrs:{id:"nav"}},[t.authenticated?n("router-link",{attrs:{to:"/",replace:""},on:{click:function(e){return t.logout()}}},[t._v("Logout")]):t._e()],1),n("router-view",{on:{authenticated:t.setAuthenticated}})],1)},c=[],u=(n("ac1f"),n("5319"),{name:"App",data:function(){return{authenticated:!1}},mounted:function(){this.authenticated||this.$router.replace({name:"login"}).catch((function(t){console.log(t)}))},methods:{setAuthenticated:function(t){this.authenticated=t},logout:function(){this.authenticated=!1}}}),l=u,h=(n("034f"),n("2877")),d=Object(h["a"])(l,a,c,!1,null,null,null),p=d.exports,f=n("8c4f"),g=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"shadow-lg p-3 mb-5 rounded",staticStyle:{"background-color":"#f1f1f1"},attrs:{id:"train"}},[n("table",[n("tr",[n("td",{staticStyle:{"vertical-align":"top"}},[n("tr",[n("td",{attrs:{colspan:"2"}},[n("div",{staticClass:"row"},[n("number-input",{attrs:{min:0,max:t.switches.length,controls:""},model:{value:t.switchid,callback:function(e){t.switchid=e},expression:"switchid"}}),n("b-form-select",{staticClass:"col-sm-3",model:{value:t.newtype,callback:function(e){t.newtype=e},expression:"newtype"}},t._l(t.types,(function(e,i){return n("option",{key:i},[t._v(" "+t._s(i)+" ")])})),0),n("b-form-input",{staticClass:"col-sm-3",attrs:{type:"color"},model:{value:t.color,callback:function(e){t.color=e},expression:"color"}})],1),n("div",{staticClass:"row"},[n("b-form-select",{staticClass:"col-sm-3",model:{value:t.rotation,callback:function(e){t.rotation=e},expression:"rotation"}},[n("option",{attrs:{value:""}},[t._v("Normal")]),n("option",{attrs:{value:"rotate(90deg)"}},[t._v("rotate right")]),n("option",{attrs:{value:"rotate(180deg)"}},[t._v("flip")]),n("option",{attrs:{value:"rotate(270deg)"}},[t._v("rotate left")])]),n("b-form-select",{staticClass:"col-sm-3",model:{value:t.printed,callback:function(e){t.printed=e},expression:"printed"}},t._l(t.printed_list,(function(e,i,r){return n("option",{key:r},[t._v(" "+t._s(i)+" ")])})),0)],1),n("div",{staticClass:"row"},[n("b-button",{attrs:{variant:"success"},on:{click:t.insertOne}},[t._v("InsertOne")]),n("b-button",{attrs:{variant:"danger"},on:{click:t.deleteAll}},[t._v("DeleteAll")]),n("b-button",{attrs:{variant:"outline-primary"},on:{click:t.setDefault}},[t._v("SetDefault")])],1)])]),t._l(t.mod2(t.switches),(function(e){return n("tr",{key:e},[n("switchrow",{attrs:{switches:t.switches,index:e,SwitchTrack:t.SwitchTrack,deleteOne:t.deleteOne}}),n("switchrow",{attrs:{switches:t.switches,index:e+1,SwitchTrack:t.SwitchTrack,deleteOne:t.deleteOne}})],1)})),n("tr",[n("td",{attrs:{colspan:"2"}},[n("b-form-textarea",{attrs:{id:"textarea"},model:{value:t.switches_str,callback:function(e){t.switches_str=e},expression:"switches_str"}})],1)]),n("tr",[n("td",{attrs:{colspan:"2"}},[n("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){return t.sendAction("setConfig")}}},[t._v("SendConfig")]),n("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){return t.sendAction("getConfig")}}},[t._v("GetConfig")])],1)])],2),n("td",{staticStyle:{"vertical-align":"top"}},[n("tr",[n("td",{attrs:{colspan:"2"}},[n("div",{staticClass:"row"},[n("b-button",{attrs:{variant:"success"},on:{click:function(e){return t.connectWs()}}},[t._v("ReconnectWs")]),n("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){return t.sendAction("scan")}}},[t._v("startScan")]),n("b-button",{attrs:{variant:"danger"},on:{click:function(e){return t.sendAction("stop")}}},[t._v("stopScan")]),n("b-button",{attrs:{variant:"primary"},on:{click:t.getHubs}},[t._v("getHubs")]),n("b-button",{attrs:{variant:"danger"},on:{click:function(e){return t.sendAction("disconnectHubs")}}},[t._v("disconnectAllHub")])],1)])]),t._l(t.trains,(function(e){return n("tr",{key:e.NAME},[n("controller",{attrs:{train:e,hubs:t.hubs,Colors:t.Colors,setPower:t.setPower}})],1)}))],2)]),n("tr"),n("tr",{directives:[{name:"show",rawName:"v-show",value:0==t.switches.length,expression:"switches.length == 0"}]},[n("td",[t._v("No switch added")])])])])},b=[],w=(n("4de4"),n("7db0"),n("4160"),n("caad"),n("a434"),n("b64b"),n("d3b7"),n("2532"),n("159b"),n("ddb0"),n("5530")),m=n("2909"),v=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("td",{staticStyle:{"max-width":"220px"}},[t.switches.length>t.index?n("b-row",{staticStyle:{"border-style":"solid","border-color":"gray",width:"100%"},attrs:{"no-gutters":""}},[n("div",{staticStyle:{"max-width":"100%",position:"relative"},on:{click:function(e){return t.SwitchTrack(t.index)}}},[n("img",{style:t.switches[t.index].img_style,attrs:{src:"Turn"==t.switches[t.index].switched?t.switches[t.index].type.startsWith("left")?"left_turn.png":"right_turn.png":t.switches[t.index].type.startsWith("left")?"left_streight.png":"right_streight.png"}}),n("div",{staticStyle:{"font-size":"12px",color:"white","background-color":"black",position:"absolute",top:"50%",left:"50%","max-width":"50%",opacity:"0.5"}},[t._v("Motor: "+t._s(t.index))]),n("img",{staticStyle:{"max-width":"10%",height:"auto",position:"absolute",top:"0%",left:"90%"},attrs:{src:"x.png"},on:{click:function(e){return t.deleteOne(t.index)}}})])]):t._e()],1)},_=[],y={props:["switches","index","SwitchTrack","deleteOne"]},S=y,O=Object(h["a"])(S,v,_,!1,null,null,null),k=O.exports,x=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("td",{staticStyle:{"max-width":"440px"}},[t.train?n("b-row",{staticStyle:{"border-style":"solid","border-color":"gray",width:"100%"},attrs:{"no-gutters":""}},[n("div",{staticStyle:{"max-width":"100%",position:"relative"}},[n("h5",[t._v(t._s(t.train.NAME))]),n("label",[t._v("Speed: ")]),n("b-form-input",{attrs:{type:"range",min:"-100",max:"100",step:"10"},on:{change:function(e){return t.setPower(t.train.NAME)}},model:{value:t.hubs[t.train.NAME].speed,callback:function(e){t.$set(t.hubs[t.train.NAME],"speed",e)},expression:"hubs[train.NAME].speed"}}),n("p",[t._v(t._s(t.hubs[t.train.NAME].speed))]),"COLOR_DISTANCE_SENSOR"in t.train?n("label",[t._v("Distance:")]):t._e(),"COLOR_DISTANCE_SENSOR"in t.train?n("b-form-input",{attrs:{type:"range",min:"0",max:"260",step:"10"},on:{change:function(e){return t.setPower(t.train.NAME)}},model:{value:t.hubs[t.train.NAME].distance,callback:function(e){t.$set(t.hubs[t.train.NAME],"distance",e)},expression:"hubs[train.NAME].distance"}}):t._e(),"COLOR_DISTANCE_SENSOR"in t.train?n("p",[t._v(t._s(t.hubs[t.train.NAME].distance))]):t._e(),"COLOR_DISTANCE_SENSOR"in t.train?n("label",[t._v("Color:")]):t._e(),t._v(" "),"COLOR_DISTANCE_SENSOR"in t.train?n("b-form-select",{style:"NONE"===t.hubs[t.train.NAME].color?"":"backgroundColor: "+t.hubs[t.train.NAME].color,model:{value:t.hubs[t.train.NAME].color,callback:function(e){t.$set(t.hubs[t.train.NAME],"color",e)},expression:"hubs[train.NAME].color"}},t._l(t.Colors,(function(e,i,r){return n("option",{key:r,style:"backgroundColor: "+i,domProps:{value:i}},[t._v(" "+t._s(i)+" ")])})),0):t._e(),n("br"),n("label",[t._v("Runtime:")]),n("b-form-input",{attrs:{type:"range",min:"0",max:"300000",step:"1000"},on:{change:function(e){return t.setPower(t.train.NAME)}},model:{value:t.hubs[t.train.NAME].duration,callback:function(e){t.$set(t.hubs[t.train.NAME],"duration",e)},expression:"hubs[train.NAME].duration"}}),n("p",[t._v(t._s(t.hubs[t.train.NAME].duration/1e3)+" sec")])],1)]):t._e()],1)},C=[],N={props:["train","hubs","Colors","setPower"]},A=N,E=Object(h["a"])(A,x,C,!1,null,null,null),T=E.exports;function M(t,e){return Object.keys(t).find((function(n){return t[n]===e}))}function P(t,e,n){var i=new WebSocket(t);return i.onmessage=function(t){var n=t.data;e(JSON.parse(n)),console.log("input: "+n)},i.onopen=function(){console.log("Successfully connected to the echo websocket server..."),n&&n("getConfig")},i}function R(){return{connection:null,connection2:null,newtype:"left",color:"#4CAF50",rotation:"",new_pulse_true:240,new_pulse_false:420,change_id:0,printed_list:{Original:!1,Printed:!0},printed:"Original",types:{left:{Original:{Straight:240,Turn:420},Printed:{Straight:280,Turn:380}},right:{Original:{Straight:420,Turn:240},Printed:{Straight:380,Turn:280}}},colors:{green:{backgroundColor:"#4CAF50"},blue:{backgroundColor:"#008CBA"},yellow:{backgroundColor:"#FFBF00"},red:{backgroundColor:"#f44336"},white:{backgroundColor:"#e7e7e7"}},switches:[{type:"left",pulse:{Straight:240,Turn:420},switched:"Straight",printed:"Original",img_style:{backgroundColor:"#4CAF50",transform:"rotate(0deg)",maxWidth:"100%",height:"auto"}},{type:"right",pulse:{Straight:420,Turn:240},switched:"Straight",printed:"Original",img_style:{backgroundColor:"#008CBA",transform:"rotate(0deg)",maxWidth:"100%",height:"auto"}},{type:"left",pulse:{Straight:240,Turn:420},switched:"Straight",printed:"Original",img_style:{backgroundColor:"#f44336",transform:"rotate(0deg)",maxWidth:"100%",height:"auto"}},{type:"right",pulse:{Straight:420,Turn:240},switched:"Straight",printed:"Original",img_style:{backgroundColor:"#e7e7e7",transform:"rotate(0deg)",maxWidth:"100%",height:"auto"}},{type:"left",pulse:{Straight:280,Turn:380},switched:"Straight",printed:"Printed",img_style:{backgroundColor:"#FFBF00",transform:"rotate(180deg)",maxWidth:"100%",height:"auto"}},{type:"right",pulse:{Straight:380,Turn:280},switched:"Straight",printed:"Printed",img_style:{backgroundColor:"#FFBF00",transform:"rotate(180deg)",maxWidth:"100%",height:"auto"}},{type:"right",pulse:{Straight:380,Turn:280},switched:"Straight",printed:"Printed",img_style:{backgroundColor:"#FFBF00",transform:"rotate(0deg)",maxWidth:"100%",height:"auto"}},{type:"left",pulse:{Straight:280,Turn:380},switched:"Straight",printed:"Printed",img_style:{backgroundColor:"#FFBF00",transform:"rotate(0deg)",maxWidth:"100%",height:"auto"}}],switches_str:"",switchid:8,apihost:"ws://guberkray.myftp.org/ws/switch",apihost2:"ws://guberkray.myftp.org/ws/train",trains:[],hubs:{},Colors:{BLACK:0,PINK:1,PURPLE:2,BLUE:3,LIGHT_BLUE:4,CYAN:5,GREEN:6,YELLOW:7,ORANGE:8,RED:9,WHITE:10,NONE:255}}}var F={name:"Train",data:function(){return R()},components:{switchrow:k,controller:T},mounted:function(){this.switches_str=JSON.stringify(this.switches,null,2)},watch:{switches_str:function(t){this.switches=JSON.parse(t)},switches:function(t){this.switches_str=JSON.stringify(t,null,2)},changePulse:function(){this.switches_str=JSON.stringify(this.switches,null,2)}},created:function(){this.connection=P(this.apihost,this.updateSwitch,null),this.connection2=P(this.apihost2,this.updateTrain,this.sendAction)},methods:{connectWs:function(){this.connection=P(this.apihost,this.updateSwitch,null),this.connection2=P(this.apihost2,this.updateTrain,null)},updateSwitch:function(t){var e=t;this.switches[e.motor].switched=M(this.switches[e.motor].pulse,e.pulse)},updateTrain:function(t){if("Connected Hubs:"===t.Status)this.trains=t.Message,this.fillHubs();else if("Setting Speed..."===t.Status){var e=t.Message;this.hubs[e.train]=e}else"SwitchConfig:"===t.Status&&(this.switches=t.Message)},mod2:function(t){return Object(m["a"])(t.keys()).filter((function(t){return t%2==0}))},setDefault:function(){Object.assign(this.$data,R()),this.connection=P(this.apihost,this.updateSwitch),this.connection2=P(this.apihost2,this.updateTrain),this.switches_str=JSON.stringify(this.switches,null,2);for(var t=0;t<this.switches.length;t++)this.sendToBE(t)},deleteAll:function(){this.switches=[]},deleteOne:function(t){this.switches.splice(t,1)},sendToBE:function(t){var e=Object(w["a"])({},this.switches[t]);"Straight"==e.switched?e.switched="Turn":e.switched="Straight";var n=e.pulse[e.switched],i=this.printed_list[e.printed],r=JSON.stringify({motor:parseInt(t),pulse:n,printed:i});this.connection.send(r)},insertOne:function(){this.switches.splice(this.switchid,0,{type:this.newtype,pulse:this.types[this.newtype][this.printed],switched:"Straight",printed:this.printed,img_style:{backgroundColor:this.color,transform:this.rotation,maxWidth:"100%",height:"auto"}}),this.switchid++},SwitchTrack:function(t){this.sendToBE(t)},sendAction:function(t){var e={action:t};t.includes("Config")&&(e.config=this.switches),console.log(e),this.connection2.send(JSON.stringify(e))},getHubs:function(){var t=JSON.stringify({action:"getHubs"});this.connection2.send(t)},setPower:function(t){var e=this.hubs[t];e["action"]="setPower",this.connection2.send(JSON.stringify(e))},fillHubs:function(){var t=this;this.trains.forEach((function(e){"TRAIN_MOTOR"in e&&t.$set(t.hubs,e.NAME,{speed:0,train:e.NAME,MotorPort:e.TRAIN_MOTOR,duration:1e4,distance:0,color:255})}))}}},j=F,W=Object(h["a"])(j,g,b,!1,null,null,null),$=W.exports,L=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"shadow-lg p-3 mb-5 rounded",attrs:{id:"login"}},[n("h1",[t._v("Login")]),n("b-form",{staticClass:"w-100",on:{submit:function(e){return e.preventDefault(),t.login(e)}}},[n("b-form-input",{attrs:{type:"text",name:"username",placeholder:"Username"},model:{value:t.input.username,callback:function(e){t.$set(t.input,"username",e)},expression:"input.username"}}),n("b-form-input",{attrs:{type:"password",name:"password",placeholder:"Password"},model:{value:t.input.password,callback:function(e){t.$set(t.input,"password",e)},expression:"input.password"}}),n("b-button",{attrs:{type:"submit",variant:"primary"}},[t._v("Login")])],1),n("div",{staticStyle:{color:"red"}},[t._v(t._s(t.message))])],1)},B=[],D={name:"Login",data:function(){return{input:{username:"",password:""},message:"",apihost:"ws://guberkray.myftp.org/ws/switch"}},methods:{login:function(){""!=this.input.username&&""!=this.input.password?"Familymember"===this.input.username&"WE4RTsdf!"===this.input.password?(this.$emit("authenticated",!0),this.$router.replace({name:"Train"})):(this.message="The username and / or password is incorrect",console.log("The username and / or password is incorrect")):(this.message="A username and password must be present",console.log("A username and password must be present"))}}},I=D,J=(n("480d"),Object(h["a"])(I,L,B,!1,null,"2437da27",null)),H=J.exports;o["default"].use(f["a"]);var G=new f["a"]({mode:"history",base:"/",routes:[{path:"/",name:"login",component:H},{path:"/train",name:"Train",component:$}]});o["default"].use(i["a"]),o["default"].component(s.a.name,s.a),new o["default"]({router:G,render:function(t){return t(p)}}).$mount("#app")},"5f41":function(t,e,n){},"85ec":function(t,e,n){}});
//# sourceMappingURL=app.2869280b.js.map